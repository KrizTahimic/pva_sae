2025-11-19 14:22:02,191 [INFO] [sae_analyzer] setup_logging:167 - Phase: 2.5, GPU: CPU
2025-11-19 14:22:02,192 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] setup_logging:167 - Phase: 8.3, GPU: CPU
2025-11-19 14:22:02,192 [INFO] [main] run_phase8_3:696 - Starting Phase 8.3: Selective Steering Based on Threshold Analysis
2025-11-19 14:22:02,192 [INFO] [main] run_phase8_3:697 - Will apply steering only when predictive direction exceeds optimal threshold
2025-11-19 14:22:02,192 [INFO] [main] run_phase8_3:698 - Automatically discovers Phase 3.8 threshold and Phase 3.5 baseline
2025-11-19 14:22:02,193 [INFO] [main] run_phase8_3:701 - 
============================================================
CONFIGURATION
============================================================

ACTIVATION Settings:
  activation_cleanup_after_batch: True
  activation_clear_cache_between_layers: True
  activation_hook_type: resid_post
  activation_layers: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
  activation_max_cache_gb: 10.0
  activation_max_length: 2048
  activation_position: -1

AUTOSAVE Settings:
  autosave_frequency: 100
  autosave_keep_last: 3

CHECKPOINT Settings:
  checkpoint_dir: checkpoints
  checkpoint_frequency: 50

CONTINUE Settings:
  continue_on_error: True

DATASET Settings:
  dataset_dir: data/phase1_0
  dataset_end_idx: 10
  dataset_name: Muennighoff/mbpp
  dataset_split: test
  dataset_start_idx: 0

ENABLE Settings:
  enable_timing_stats: True

EVALUATION Settings:
  evaluation_random_seed: 42

GC Settings:
  gc_collect_frequency: 50

LOG Settings:
  log_dir: data/logs

MAX Settings:
  max_gpu_memory_usage_gb: 30.0
  max_memory_usage_gb: 100.0
  max_retries: 3

MEMORY Settings:
  memory_cleanup_frequency: 100

MODEL Settings:
  model_device: None
  model_dtype: None
  model_max_new_tokens: 800
  model_name: google/gemma-2-2b
  model_temperature: 0.0
  model_trust_remote_code: True

ORTHOGONALIZATION Settings:
  orthogonalization_target_weights: [embed, attn_o, mlp_down]

PHASE0 Settings:
  phase0_1_output_dir: data/phase0_1
  phase0_output_dir: data/phase0

PHASE1 Settings:
  phase1_output_dir: data/phase1_0

PHASE2 Settings:
  phase2_10_output_dir: data/phase2_10
  phase2_15_output_dir: data/phase2_15
  phase2_2_output_dir: data/phase2_2
  phase2_5_output_dir: data/phase2_5
  phase2_output_dir: data/phase2

PHASE3 Settings:
  phase3_10_output_dir: data/phase3_10
  phase3_10_temperatures: [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]
  phase3_11_output_dir: data/phase3_11
  phase3_12_output_dir: data/phase3_12
  phase3_5_output_dir: data/phase3_5
  phase3_6_output_dir: data/phase3_6
  phase3_8_output_dir: data/phase3_8
  phase3_output_dir: data/phase3

PHASE4 Settings:
  phase4_10_min_activation_freq: 0.001
  phase4_10_n_features: 10
  phase4_10_output_dir: data/phase4_10
  phase4_10_separation_threshold: 0.01
  phase4_12_output_dir: data/phase4_12
  phase4_14_output_dir: data/phase4_14
  phase4_14_significance_level: 0.05
  phase4_5_correct_coefficients: [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]
  phase4_5_experiment_mode: all
  phase4_5_incorrect_coefficients: [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0]
  phase4_5_meaningful_effect_threshold: 5.0
  phase4_5_output_dir: data/phase4_5
  phase4_5_plateau_threshold: 2.0
  phase4_5_search_tolerance: 2.0
  phase4_6_experiment_mode: all
  phase4_6_output_dir: data/phase4_6
  phase4_6_tolerance: 1.0
  phase4_8_correct_coefficient: 29
  phase4_8_experiment_mode: all
  phase4_8_incorrect_coefficient: 287
  phase4_8_output_dir: data/phase4_8

PHASE5 Settings:
  phase5_3_output_dir: data/phase5_3
  phase5_6_output_dir: data/phase5_6
  phase5_9_output_dir: data/phase5_9
  phase5_9_significance_level: 0.05

PHASE6 Settings:
  phase6_3_output_dir: data/phase6_3

PHASE7 Settings:
  phase7_12_output_dir: data/phase7_12
  phase7_3_model_name: google/gemma-2-2b-it
  phase7_3_output_dir: data/phase7_3
  phase7_6_model_name: google/gemma-2-2b-it
  phase7_6_output_dir: data/phase7_6

PHASE8 Settings:
  **phase8_3_output_dir**: data/phase8_3
  **phase8_3_percentile**: 90.0
  **phase8_3_use_percentile_threshold**: True
  phase8_1_output_dir: data/phase8_1

PILE Settings:
  pile_filter_enabled: True
  pile_samples: 10000
  pile_threshold: 0.02

PROGRESS Settings:
  progress_log_frequency: 10

RETRY Settings:
  retry_backoff: 1.0

SAE Settings:
  sae_checkpoint_dir: data/phase2/sae_checkpoints
  sae_cleanup_after_layer: True
  sae_hook_component: resid_post
  sae_latent_threshold: 0.02
  sae_repo_id: google/gemma-scope-2b-pt-res
  sae_save_after_each_layer: True
  sae_sparsity: 71
  sae_use_memory_mapping: False
  sae_width: 16k

SHOW Settings:
  show_progress_bar: True

SPLIT Settings:
  split_n_strata: 10
  split_random_seed: 42
  split_ratio_tolerance: 0.02

T Settings:
  t_statistic_min_samples: 10

TEMPERATURE Settings:
  temperature_samples_per_temp: 3
  temperature_variation_temps: [0.0]

TIMEOUT Settings:
  timeout_per_record: 300.0

VERBOSE Settings:
  verbose: False

============================================================
2025-11-19 14:22:02,193 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] __init__:103 - Initializing Selective Steering Analyzer
2025-11-19 14:22:02,193 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] __init__:104 - Device: cuda
2025-11-19 14:22:02,193 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] __init__:105 - Output directory: data/phase8_3
2025-11-19 14:22:02,194 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:114 - Loading dependencies...
2025-11-19 14:22:02,194 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:117 - Loading model and tokenizer...
2025-11-19 14:22:02,383 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:47 - Loading model google/gemma-2-2b on cuda with dtype torch.bfloat16
2025-11-19 14:22:03,962 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:56 - Loading model to cuda...
2025-11-19 14:22:08,360 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:83 - Model successfully loaded on cuda:0
2025-11-19 14:22:08,360 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:85 - Model loaded successfully: Gemma2ForCausalLM
2025-11-19 14:22:08,361 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:86 - Model size: 2.61B parameters
2025-11-19 14:22:08,361 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:123 - Model loaded: google/gemma-2-2b
2025-11-19 14:22:08,362 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:126 - Loading optimal threshold from Phase 3.8...
2025-11-19 14:22:08,362 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:141 - Incorrect-predicting feature: Layer 19, Feature 5441
2025-11-19 14:22:08,363 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:143 - Phase 3.8 optimal threshold: 15.5086
2025-11-19 14:22:08,363 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:146 - Loading steering features from Phase 2.5...
2025-11-19 14:22:08,363 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:162 - Correct-steering feature: Layer 16, Feature 11225, Score 0.2212
2025-11-19 14:22:08,363 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:167 - Loading SAE models...
2025-11-19 14:22:08,363 [INFO] [sae_analyzer] load_gemma_scope_sae:47 - Loading GemmaScope SAE for layer 19
2025-11-19 14:22:08,364 [INFO] [sae_analyzer] load_gemma_scope_sae:61 - Loading from HuggingFace: google/gemma-scope-2b-pt-res/layer_19/width_16k/average_l0_73/params.npz
2025-11-19 14:22:08,364 [INFO] [sae_analyzer] load_gemma_scope_sae:62 - This may take a while if the model is not cached...
2025-11-19 14:22:08,573 [INFO] [sae_analyzer] load_gemma_scope_sae:70 - Download complete, loading from: /home/kriz_tahimic/.cache/huggingface/hub/models--google--gemma-scope-2b-pt-res/snapshots/fd571b47c1c64851e9b1989792367b9babb4af63/layer_19/width_16k/average_l0_73/params.npz
2025-11-19 14:22:09,887 [INFO] [sae_analyzer] load_gemma_scope_sae:87 - Loaded SAE with d_model=2304, d_sae=16384, sparsity=73
2025-11-19 14:22:09,887 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:171 - Loaded SAE for Layer 19 (threshold checking)
2025-11-19 14:22:09,888 [INFO] [sae_analyzer] load_gemma_scope_sae:47 - Loading GemmaScope SAE for layer 16
2025-11-19 14:22:09,888 [INFO] [sae_analyzer] load_gemma_scope_sae:61 - Loading from HuggingFace: google/gemma-scope-2b-pt-res/layer_16/width_16k/average_l0_78/params.npz
2025-11-19 14:22:09,888 [INFO] [sae_analyzer] load_gemma_scope_sae:62 - This may take a while if the model is not cached...
2025-11-19 14:22:10,092 [INFO] [sae_analyzer] load_gemma_scope_sae:70 - Download complete, loading from: /home/kriz_tahimic/.cache/huggingface/hub/models--google--gemma-scope-2b-pt-res/snapshots/fd571b47c1c64851e9b1989792367b9babb4af63/layer_16/width_16k/average_l0_78/params.npz
2025-11-19 14:22:11,380 [INFO] [sae_analyzer] load_gemma_scope_sae:87 - Loaded SAE with d_model=2304, d_sae=16384, sparsity=78
2025-11-19 14:22:11,381 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:175 - Loaded SAE for Layer 16 (steering)
2025-11-19 14:22:11,403 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:183 - Decoder direction converted to model dtype: torch.bfloat16
2025-11-19 14:22:11,404 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:186 - Loading baseline data from Phase 3.5...
2025-11-19 14:22:11,436 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:197 - Loaded 388 problems from Phase 3.5 baseline
2025-11-19 14:22:11,438 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:204 - Parsed test_list JSON strings to lists
2025-11-19 14:22:11,456 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:223 - ✓ Validation passed: test_list is list with 3 test cases
2025-11-19 14:22:11,456 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:240 - Processing validation dataset rows 0-10 (inclusive)
2025-11-19 14:22:11,457 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:242 - Filtered to 11 problems
2025-11-19 14:22:11,457 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:246 - Loading 90.0th percentile threshold from Phase 8.1...
2025-11-19 14:22:11,457 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:261 - ✓ Using Phase 8.1 p90 threshold: 22.2769
2025-11-19 14:22:11,457 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:262 -   (Calculated from 97 samples in Phase 3.6 hyperparams set)
2025-11-19 14:22:11,457 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:263 -   Will steer approximately 10% of cases
2025-11-19 14:22:11,457 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:264 -   Phase 3.8 classification threshold was: 15.5086
2025-11-19 14:22:11,457 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _load_dependencies:276 - Dependencies loaded successfully
2025-11-19 14:22:11,458 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] __init__:110 - Initialization complete
2025-11-19 14:22:11,458 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:894 - ============================================================
2025-11-19 14:22:11,458 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:895 - Starting Phase 8.3: Selective Steering Analysis
2025-11-19 14:22:11,458 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:896 - ============================================================
2025-11-19 14:22:11,458 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _split_baseline_by_correctness:283 - Splitting baseline by initial correctness...
2025-11-19 14:22:11,459 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _split_baseline_by_correctness:293 - Split complete:
2025-11-19 14:22:11,459 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _split_baseline_by_correctness:294 -   Initially incorrect: 6 (54.5%)
2025-11-19 14:22:11,459 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _split_baseline_by_correctness:295 -   Initially correct: 5 (45.5%)
2025-11-19 14:22:11,459 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:902 - 
============================================================
2025-11-19 14:22:11,459 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:903 - EXPERIMENT 1: Selective Correction (initially incorrect problems)
2025-11-19 14:22:11,459 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:904 - ============================================================
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] load_checkpoint:857 - Loading checkpoint from checkpoint_correction_20251119_135744.json
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] load_checkpoint:861 - Resuming correction experiment from index 3/3
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:492 - Resuming from checkpoint at index 4
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:499 - 
============================================================
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:500 - EXPERIMENT: CORRECTION
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:501 - ============================================================
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:504 - Processing 6 initially incorrect problems
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:505 - Goal: Measure selective correction rate
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:510 - Threshold: 22.2769 (Layer 19, Feature 5441)
2025-11-19 14:22:11,460 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:511 - Steering: Layer 16, Feature 11225, Coefficient 29
2025-11-19 14:22:11,461 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:512 - ============================================================

2025-11-19 14:22:20,546 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:546 -   [5/6] Task 20: ✗ BASELINE (L19-5441: 19.36, threshold: 22.28)
2025-11-19 14:22:23,912 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:546 -   [6/6] Task 24: ✗ BASELINE (L19-5441: 18.27, threshold: 22.28)
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:612 - 
============================================================
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:613 - RESULTS: CORRECTION EXPERIMENT
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:614 - ============================================================
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:615 - Total problems: 6
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:616 - Errors: 0 (0.0%)
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:617 - Successful: 6 (100.0%)
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:618 - 
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:619 - Steering decisions:
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:620 -   Steered: 4 (66.7%)
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:621 -   Used baseline: 2 (33.3%)
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:622 - 
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:626 - Outcomes:
2025-11-19 14:22:23,913 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:627 -   Corrected: 0 (0.00%)
2025-11-19 14:22:23,914 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:628 -   Correction rate: 0.00%
2025-11-19 14:22:23,914 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:636 - ============================================================

2025-11-19 14:22:23,914 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:647 - Saving final checkpoint for correction experiment
2025-11-19 14:22:23,914 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] save_checkpoint:842 - Saved correction checkpoint at index 5/5
2025-11-19 14:22:23,915 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:914 - ✓ Saved 6 correction results to all_selective_correction_results.json
2025-11-19 14:22:23,915 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:917 - 
============================================================
2025-11-19 14:22:23,915 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:918 - EXPERIMENT 2: Selective Preservation (initially correct problems)
2025-11-19 14:22:23,915 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:919 - ============================================================
2025-11-19 14:22:23,915 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] load_checkpoint:857 - Loading checkpoint from checkpoint_preservation_20251119_135745.json
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] load_checkpoint:861 - Resuming preservation experiment from index 0/0
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:492 - Resuming from checkpoint at index 1
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:499 - 
============================================================
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:500 - EXPERIMENT: PRESERVATION
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:501 - ============================================================
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:507 - Processing 5 initially correct problems
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:508 - Goal: Measure selective preservation rate
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:510 - Threshold: 22.2769 (Layer 19, Feature 5441)
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:511 - Steering: Layer 16, Feature 11225, Coefficient 29
2025-11-19 14:22:23,916 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:512 - ============================================================

2025-11-19 14:22:24,732 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:546 -   [2/5] Task 17: ✓ BASELINE (L19-5441: 16.82, threshold: 22.28)
2025-11-19 14:22:26,346 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:546 -   [3/5] Task 18: ✓ BASELINE (L19-5441: 20.05, threshold: 22.28)
2025-11-19 14:22:27,893 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:546 -   [4/5] Task 21: ✓ BASELINE (L19-5441: 19.42, threshold: 22.28)
2025-11-19 14:22:31,096 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:546 -   [5/5] Task 22: ✓ BASELINE (L19-5441: 19.10, threshold: 22.28)
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:612 - 
============================================================
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:613 - RESULTS: PRESERVATION EXPERIMENT
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:614 - ============================================================
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:615 - Total problems: 5
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:616 - Errors: 0 (0.0%)
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:617 - Successful: 5 (100.0%)
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:618 - 
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:619 - Steering decisions:
2025-11-19 14:22:31,097 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:620 -   Steered: 1 (20.0%)
2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:621 -   Used baseline: 4 (80.0%)
2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:622 - 
2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:632 - Outcomes:
2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:633 -   Preserved: 5 (100.00%)
2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:634 -   Corrupted: 0 (0.00%)
2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:636 - ============================================================

2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _apply_selective_steering:647 - Saving final checkpoint for preservation experiment
2025-11-19 14:22:31,098 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] save_checkpoint:842 - Saved preservation checkpoint at index 4/4
2025-11-19 14:22:31,099 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:929 - ✓ Saved 5 preservation results to all_selective_preservation_results.json
2025-11-19 14:22:31,099 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:932 - 
============================================================
2025-11-19 14:22:31,099 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:933 - Calculating metrics...
2025-11-19 14:22:31,099 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:934 - ============================================================
2025-11-19 14:22:31,100 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:962 - ✓ Saved summary to selective_steering_summary.json
2025-11-19 14:22:31,100 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] _save_example_comparisons:815 - ✓ Saved 1 preserved steered examples to preserved_steered_examples.json
2025-11-19 14:22:31,100 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:968 - 
================================================================================
2025-11-19 14:22:31,100 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:969 - PHASE 8.3 COMPLETE - SELECTIVE STEERING RESULTS
2025-11-19 14:22:31,100 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:970 - ================================================================================
2025-11-19 14:22:31,100 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:972 - 
------------------CORRECTION EXPERIMENT (Initially Incorrect)-------------------
2025-11-19 14:22:31,100 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:973 -   Total problems: 6
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:974 -   Valid problems: 6
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:975 - 
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:976 -   Steering decisions:
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:977 -     - Steered (activation > threshold): 4 (66.7%)
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:978 -     - Used baseline (activation ≤ threshold): 2 (33.3%)
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:979 - 
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:980 -   Outcomes:
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:981 -     - Corrected (incorrect → correct): 0 (0.00%)
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:982 -     - Correction efficiency (of steered): 0.0%
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:983 - 
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:984 -   L19 Feature Activations:
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:989 -     - Mean: 19.94
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:990 -     - Range: [18.27, 23.08]
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:994 - 
------------------PRESERVATION EXPERIMENT (Initially Correct)-------------------
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:995 -   Total problems: 5
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:996 -   Valid problems: 5
2025-11-19 14:22:31,101 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:997 - 
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:998 -   Steering decisions:
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:999 -     - Steered (activation > threshold): 1 (20.0%)
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1000 -     - Used baseline (activation ≤ threshold): 4 (80.0%)
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1001 - 
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1002 -   Outcomes:
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1003 -     - Preserved (correct → correct): 5 (100.00%)
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1004 -     - Corrupted (correct → incorrect): 0 (0.00%)
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1005 - 
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1006 -   L19 Feature Activations:
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1011 -     - Mean: 18.75
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1012 -     - Range: [16.82, 20.05]
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1016 - 
--------------------------------COMBINED METRICS--------------------------------
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1017 -   Total problems processed: 11
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1018 -   Total steered: 5 (45.5%)
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1020 - 
---------------COMPARISON TO PHASE 4.8 (Always-Steering Baseline)---------------
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1021 - 
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1022 -   Metric                                         Phase 4.8       Phase 8.3
2025-11-19 14:22:31,102 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1023 -   ----------------------------------------------------------------------
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1024 -   Correction Rate                                    4.04%           0.00%
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1025 -   Corruption Rate                                   14.66%           0.00%
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1026 -   Preservation Rate                                 85.34%         100.00%
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1027 -   Steering Rate                                     100.00           45.5%
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1028 -   ----------------------------------------------------------------------
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1029 - 
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1030 -   Key Insights:
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1035 -     ✓ Corruption reduced by 14.66 percentage points
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1041 -     ✓ Steering rate reduced by 54.5 percentage points
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1051 -     ⚠ Correction rate decreased by 4.04 percentage points
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1053 - 
================================================================================
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1054 - Output files saved to: data/phase8_3
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1055 -   - data/phase8_3/all_selective_correction_results.json
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1056 -   - data/phase8_3/all_selective_preservation_results.json
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1057 -   - data/phase8_3/selective_steering_summary.json
2025-11-19 14:22:31,103 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1058 -   - data/phase8_3/examples (corrected and preserved steered examples)
2025-11-19 14:22:31,104 [INFO] [phase8_3_selective_steering.selective_steering_analyzer] run:1059 - ================================================================================
2025-11-19 14:22:31,104 [INFO] [main] run_phase8_3:707 - 
✅ Phase 8.3 completed successfully
