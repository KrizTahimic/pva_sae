2025-11-21 16:28:27,590 [INFO] [test_mbpp_with_imports] setup_logging:167 - Phase: TEST, GPU: CPU
2025-11-21 16:28:27,591 [WARNING] [test_mbpp_with_imports] main:519 - Config dataset is 'humaneval', forcing to 'mbpp'
2025-11-21 16:28:27,616 [INFO] [test_mbpp_with_imports] __init__:219 - Loading model google/gemma-2-2b on device: cuda
2025-11-21 16:28:27,804 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:47 - Loading model google/gemma-2-2b on cuda with dtype torch.bfloat16
2025-11-21 16:28:29,338 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:56 - Loading model to cuda...
2025-11-21 16:28:33,361 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:86 - Model successfully loaded on cuda:0
2025-11-21 16:28:33,361 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:88 - Model loaded successfully: Gemma2ForCausalLM
2025-11-21 16:28:33,362 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:89 - Model size: 2.61B parameters
2025-11-21 16:28:33,364 [INFO] [test_mbpp_with_imports] __init__:241 - Initialized random seeds (seed=42) for deterministic generation
2025-11-21 16:28:33,364 [INFO] [test_mbpp_with_imports] __init__:248 - Using layers: [16, 19]
2025-11-21 16:28:33,364 [INFO] [common_simplified.activation_hooks] __init__:185 - Initialized AttentionExtractor for layers [16, 19] at position -1
2025-11-21 16:28:33,364 [INFO] [test_mbpp_with_imports] run:329 - ======================================================================
2025-11-21 16:28:33,365 [INFO] [test_mbpp_with_imports] run:330 - MBPP IMPORT PRE-LOADING TEST
2025-11-21 16:28:33,365 [INFO] [test_mbpp_with_imports] run:331 - ======================================================================
2025-11-21 16:28:33,365 [INFO] [test_mbpp_with_imports] run:332 - Testing with 73 standard library imports pre-loaded
2025-11-21 16:28:33,365 [INFO] [test_mbpp_with_imports] run:333 - Dataset: mbpp
2025-11-21 16:28:33,365 [INFO] [test_mbpp_with_imports] run:334 - Model: google/gemma-2-2b
2025-11-21 16:28:33,387 [INFO] [test_mbpp_with_imports] run:342 - Loaded 388 validation problems
2025-11-21 16:28:33,387 [INFO] [test_mbpp_with_imports] run:346 - Processing rows 0 to 4 (inclusive)
2025-11-21 16:28:33,388 [INFO] [test_mbpp_with_imports] run:348 - Testing on 5 problems
2025-11-21 16:28:33,388 [INFO] [test_mbpp_with_imports] run:355 - Output directory: data/test_imports
2025-11-21 16:28:33,389 [INFO] [common_simplified.activation_hooks] setup_hooks:53 - Set up hooks for 2 layers to capture residual stream
2025-11-21 16:28:33,390 [INFO] [common_simplified.activation_hooks] setup_hooks:204 - Set up attention hooks for 2 layers
2025-11-21 16:28:44,905 [INFO] [common_simplified.activation_hooks] setup_hooks:53 - Set up hooks for 2 layers to capture residual stream
2025-11-21 16:28:44,905 [INFO] [common_simplified.activation_hooks] setup_hooks:204 - Set up attention hooks for 2 layers
2025-11-21 16:29:32,012 [INFO] [common_simplified.activation_hooks] setup_hooks:53 - Set up hooks for 2 layers to capture residual stream
2025-11-21 16:29:32,012 [INFO] [common_simplified.activation_hooks] setup_hooks:204 - Set up attention hooks for 2 layers
2025-11-21 16:29:33,433 [INFO] [common_simplified.activation_hooks] setup_hooks:53 - Set up hooks for 2 layers to capture residual stream
2025-11-21 16:29:33,434 [INFO] [common_simplified.activation_hooks] setup_hooks:204 - Set up attention hooks for 2 layers
2025-11-21 16:29:35,442 [INFO] [common_simplified.activation_hooks] setup_hooks:53 - Set up hooks for 2 layers to capture residual stream
2025-11-21 16:29:35,442 [INFO] [common_simplified.activation_hooks] setup_hooks:204 - Set up attention hooks for 2 layers
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:477 - ======================================================================
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:478 - TEST COMPLETE
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:479 - ======================================================================
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:480 - Problems tested: 5
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:481 - Passed: 1
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:482 - Failed: 4
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:483 - Pass rate: 20.00%
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:484 - Avg generation time: 12.68s
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:485 - 
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:486 - Output files:
2025-11-21 16:29:36,812 [INFO] [test_mbpp_with_imports] run:487 -   - data/test_imports/SUMMARY.txt
2025-11-21 16:29:36,813 [INFO] [test_mbpp_with_imports] run:488 -   - data/test_imports/results.parquet
2025-11-21 16:29:36,813 [INFO] [test_mbpp_with_imports] run:489 -   - data/test_imports/metadata.json
2025-11-21 16:29:36,813 [INFO] [test_mbpp_with_imports] run:490 - ======================================================================
