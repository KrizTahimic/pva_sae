2025-11-19 16:07:40,112 [INFO] [sae_analyzer] setup_logging:167 - Phase: 2.5, GPU: CPU
2025-11-19 16:07:40,113 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] setup_logging:167 - Phase: 8.2, GPU: CPU
2025-11-19 16:07:40,113 [INFO] [phase8_2_threshold_optimizer.runner] setup_logging:167 - Phase: 8.2, GPU: CPU
2025-11-19 16:07:40,113 [INFO] [main] run_phase8_2:696 - 
============================================================
2025-11-19 16:07:40,113 [INFO] [main] run_phase8_2:697 - PHASE 8.2: PERCENTILE THRESHOLD OPTIMIZER
2025-11-19 16:07:40,113 [INFO] [main] run_phase8_2:698 - ============================================================
2025-11-19 16:07:40,113 [INFO] [main] run_phase8_2:699 - Optimizes threshold selection across percentiles using hyperparameter dataset
2025-11-19 16:07:40,114 [INFO] [main] run_phase8_2:700 - Tests percentiles from Phase 8.1 to maximize net benefit (correction - corruption)
2025-11-19 16:07:40,114 [INFO] [main] run_phase8_2:701 - 
2025-11-19 16:07:40,114 [INFO] [main] run_phase8_2:704 - 
============================================================
CONFIGURATION
============================================================

ACTIVATION Settings:
  activation_cleanup_after_batch: True
  activation_clear_cache_between_layers: True
  activation_hook_type: resid_post
  activation_layers: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
  activation_max_cache_gb: 10.0
  activation_max_length: 2048
  activation_position: -1

AUTOSAVE Settings:
  autosave_frequency: 100
  autosave_keep_last: 3

CHECKPOINT Settings:
  checkpoint_dir: checkpoints
  checkpoint_frequency: 50

CONTINUE Settings:
  continue_on_error: True

DATASET Settings:
  dataset_dir: data/phase1_0
  dataset_end_idx: None
  dataset_name: Muennighoff/mbpp
  dataset_split: test
  dataset_start_idx: 0

ENABLE Settings:
  enable_timing_stats: True

EVALUATION Settings:
  evaluation_random_seed: 42

GC Settings:
  gc_collect_frequency: 50

LOG Settings:
  log_dir: data/logs

MAX Settings:
  max_gpu_memory_usage_gb: 30.0
  max_memory_usage_gb: 100.0
  max_retries: 3

MEMORY Settings:
  memory_cleanup_frequency: 100

MODEL Settings:
  model_device: None
  model_dtype: None
  model_max_new_tokens: 800
  model_name: google/gemma-2-2b
  model_temperature: 0.0
  model_trust_remote_code: True

ORTHOGONALIZATION Settings:
  orthogonalization_target_weights: [embed, attn_o, mlp_down]

PHASE0 Settings:
  phase0_1_output_dir: data/phase0_1
  phase0_output_dir: data/phase0

PHASE1 Settings:
  phase1_output_dir: data/phase1_0

PHASE2 Settings:
  phase2_10_output_dir: data/phase2_10
  phase2_15_output_dir: data/phase2_15
  phase2_2_output_dir: data/phase2_2
  phase2_5_output_dir: data/phase2_5
  phase2_output_dir: data/phase2

PHASE3 Settings:
  phase3_10_output_dir: data/phase3_10
  phase3_10_temperatures: [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]
  phase3_11_output_dir: data/phase3_11
  phase3_12_output_dir: data/phase3_12
  phase3_5_output_dir: data/phase3_5
  phase3_6_output_dir: data/phase3_6
  phase3_8_output_dir: data/phase3_8
  phase3_output_dir: data/phase3

PHASE4 Settings:
  phase4_10_min_activation_freq: 0.001
  phase4_10_n_features: 10
  phase4_10_output_dir: data/phase4_10
  phase4_10_separation_threshold: 0.01
  phase4_12_output_dir: data/phase4_12
  phase4_14_output_dir: data/phase4_14
  phase4_14_significance_level: 0.05
  phase4_5_correct_coefficients: [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0]
  phase4_5_experiment_mode: all
  phase4_5_incorrect_coefficients: [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0, 800.0, 900.0, 1000.0]
  phase4_5_meaningful_effect_threshold: 5.0
  phase4_5_output_dir: data/phase4_5
  phase4_5_plateau_threshold: 2.0
  phase4_5_search_tolerance: 2.0
  phase4_6_experiment_mode: all
  phase4_6_output_dir: data/phase4_6
  phase4_6_tolerance: 1.0
  phase4_8_correct_coefficient: 29
  phase4_8_experiment_mode: all
  phase4_8_incorrect_coefficient: 287
  phase4_8_output_dir: data/phase4_8

PHASE5 Settings:
  phase5_3_output_dir: data/phase5_3
  phase5_6_output_dir: data/phase5_6
  phase5_9_output_dir: data/phase5_9
  phase5_9_significance_level: 0.05

PHASE6 Settings:
  phase6_3_output_dir: data/phase6_3

PHASE7 Settings:
  phase7_12_output_dir: data/phase7_12
  phase7_3_model_name: google/gemma-2-2b-it
  phase7_3_output_dir: data/phase7_3
  phase7_6_model_name: google/gemma-2-2b-it
  phase7_6_output_dir: data/phase7_6

PHASE8 Settings:
  **phase8_2_output_dir**: data/phase8_2
  phase8_1_output_dir: data/phase8_1
  phase8_3_output_dir: data/phase8_3
  phase8_3_percentile: 90.0
  phase8_3_use_percentile_threshold: True

PILE Settings:
  pile_filter_enabled: True
  pile_samples: 10000
  pile_threshold: 0.02

PROGRESS Settings:
  progress_log_frequency: 10

RETRY Settings:
  retry_backoff: 1.0

SAE Settings:
  sae_checkpoint_dir: data/phase2/sae_checkpoints
  sae_cleanup_after_layer: True
  sae_hook_component: resid_post
  sae_latent_threshold: 0.02
  sae_repo_id: google/gemma-scope-2b-pt-res
  sae_save_after_each_layer: True
  sae_sparsity: 71
  sae_use_memory_mapping: False
  sae_width: 16k

SHOW Settings:
  show_progress_bar: True

SPLIT Settings:
  split_n_strata: 10
  split_random_seed: 42
  split_ratio_tolerance: 0.02

T Settings:
  t_statistic_min_samples: 10

TEMPERATURE Settings:
  temperature_samples_per_temp: 3
  temperature_variation_temps: [0.0]

TIMEOUT Settings:
  timeout_per_record: 300.0

VERBOSE Settings:
  verbose: False

============================================================
2025-11-19 16:07:40,115 [INFO] [phase8_2_threshold_optimizer.runner] run_phase_8_2:28 - Starting Phase 8.2: Percentile Threshold Optimizer
2025-11-19 16:07:40,115 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] __init__:102 - Initializing Percentile Threshold Optimizer
2025-11-19 16:07:40,115 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] __init__:103 - Device: cuda
2025-11-19 16:07:40,115 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] __init__:104 - Output directory: data/phase8_2
2025-11-19 16:07:40,115 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:113 - Loading dependencies...
2025-11-19 16:07:40,115 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:116 - Loading model and tokenizer...
2025-11-19 16:07:40,311 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:47 - Loading model google/gemma-2-2b on cuda with dtype torch.bfloat16
2025-11-19 16:07:41,865 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:56 - Loading model to cuda...
2025-11-19 16:07:46,239 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:83 - Model successfully loaded on cuda:0
2025-11-19 16:07:46,239 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:85 - Model loaded successfully: Gemma2ForCausalLM
2025-11-19 16:07:46,240 [INFO] [common_simplified.model_loader] load_model_and_tokenizer:86 - Model size: 2.61B parameters
2025-11-19 16:07:46,240 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:122 - Model loaded: google/gemma-2-2b
2025-11-19 16:07:46,240 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:125 - Loading incorrect-predicting feature info from Phase 3.8...
2025-11-19 16:07:46,241 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:137 - Incorrect-predicting feature: Layer 19, Feature 5441
2025-11-19 16:07:46,241 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:141 - Loading steering features from Phase 2.5...
2025-11-19 16:07:46,242 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:157 - Correct-steering feature: Layer 16, Feature 11225, Score 0.2212
2025-11-19 16:07:46,242 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:162 - Loading SAE models...
2025-11-19 16:07:46,242 [INFO] [sae_analyzer] load_gemma_scope_sae:47 - Loading GemmaScope SAE for layer 19
2025-11-19 16:07:46,242 [INFO] [sae_analyzer] load_gemma_scope_sae:61 - Loading from HuggingFace: google/gemma-scope-2b-pt-res/layer_19/width_16k/average_l0_73/params.npz
2025-11-19 16:07:46,242 [INFO] [sae_analyzer] load_gemma_scope_sae:62 - This may take a while if the model is not cached...
2025-11-19 16:07:46,475 [INFO] [sae_analyzer] load_gemma_scope_sae:70 - Download complete, loading from: /home/kriz_tahimic/.cache/huggingface/hub/models--google--gemma-scope-2b-pt-res/snapshots/fd571b47c1c64851e9b1989792367b9babb4af63/layer_19/width_16k/average_l0_73/params.npz
2025-11-19 16:07:47,356 [INFO] [sae_analyzer] load_gemma_scope_sae:87 - Loaded SAE with d_model=2304, d_sae=16384, sparsity=73
2025-11-19 16:07:47,356 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:166 - Loaded SAE for Layer 19 (threshold checking)
2025-11-19 16:07:47,357 [INFO] [sae_analyzer] load_gemma_scope_sae:47 - Loading GemmaScope SAE for layer 16
2025-11-19 16:07:47,357 [INFO] [sae_analyzer] load_gemma_scope_sae:61 - Loading from HuggingFace: google/gemma-scope-2b-pt-res/layer_16/width_16k/average_l0_78/params.npz
2025-11-19 16:07:47,357 [INFO] [sae_analyzer] load_gemma_scope_sae:62 - This may take a while if the model is not cached...
2025-11-19 16:07:47,569 [INFO] [sae_analyzer] load_gemma_scope_sae:70 - Download complete, loading from: /home/kriz_tahimic/.cache/huggingface/hub/models--google--gemma-scope-2b-pt-res/snapshots/fd571b47c1c64851e9b1989792367b9babb4af63/layer_16/width_16k/average_l0_78/params.npz
2025-11-19 16:07:48,434 [INFO] [sae_analyzer] load_gemma_scope_sae:87 - Loaded SAE with d_model=2304, d_sae=16384, sparsity=78
2025-11-19 16:07:48,435 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:170 - Loaded SAE for Layer 16 (steering)
2025-11-19 16:07:48,447 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:178 - Decoder direction converted to model dtype: torch.bfloat16
2025-11-19 16:07:48,447 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:182 - Using Phase 4.8 optimal coefficient: 29
2025-11-19 16:07:48,447 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:185 - Loading MBPP problem specifications from Phase 0.1...
2025-11-19 16:07:48,472 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:196 - Loaded 97 hyperparameter problems from Phase 0.1
2025-11-19 16:07:48,472 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:209 - Loading baseline correctness labels from Phase 3.6...
2025-11-19 16:07:48,478 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:225 - Loaded baseline correctness labels for 97 problems from Phase 3.6
2025-11-19 16:07:48,478 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:228 - Merging Phase 0.1 prompts with Phase 3.6 correctness labels...
2025-11-19 16:07:48,480 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:238 - Merged dataset: 97 problems
2025-11-19 16:07:48,480 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _split_baseline_by_correctness:281 - Splitting dataset by initial correctness...
2025-11-19 16:07:48,481 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _split_baseline_by_correctness:291 - Split complete:
2025-11-19 16:07:48,481 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _split_baseline_by_correctness:292 -   Initially incorrect: 69 (71.1%)
2025-11-19 16:07:48,481 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _split_baseline_by_correctness:293 -   Initially correct: 28 (28.9%)
2025-11-19 16:07:48,482 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:262 - Loading percentile thresholds from Phase 8.1...
2025-11-19 16:07:48,482 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:273 - Loaded 6 percentile thresholds from Phase 8.1
2025-11-19 16:07:48,482 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:275 -   p50: 19.2843 (steer top 50%)
2025-11-19 16:07:48,482 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:275 -   p75: 21.0463 (steer top 25%)
2025-11-19 16:07:48,482 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:275 -   p80: 21.5797 (steer top 20%)
2025-11-19 16:07:48,483 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:275 -   p85: 21.7197 (steer top 15%)
2025-11-19 16:07:48,483 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:275 -   p90: 22.2769 (steer top 10%)
2025-11-19 16:07:48,483 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:275 -   p95: 23.0295 (steer top 5%)
2025-11-19 16:07:48,483 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _load_dependencies:277 - Dependencies loaded successfully
2025-11-19 16:07:48,483 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] __init__:109 - Initialization complete
2025-11-19 16:07:48,483 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] run:1027 - ============================================================
2025-11-19 16:07:48,483 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] run:1028 - Starting Phase 8.2: Percentile Threshold Optimizer
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] run:1029 - ============================================================
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:737 - ============================================================
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:738 - STARTING GRID SEARCH OPTIMIZATION
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:739 - ============================================================
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:740 - Testing percentiles: [50, 75, 80, 85, 90, 95]
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:741 - Incorrect problems: 69
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:742 - Correct problems: 28
2025-11-19 16:07:48,484 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:743 - ============================================================
2025-11-19 16:07:48,485 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:749 - 
============================================================
2025-11-19 16:07:48,485 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:750 - TESTING PERCENTILE: 50th
2025-11-19 16:07:48,485 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:751 - ============================================================
2025-11-19 16:07:48,485 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:757 - Threshold: 19.2843
2025-11-19 16:07:48,485 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:758 - Expected steering rate: ~50%
2025-11-19 16:07:48,485 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:767 - 
--- Correction Experiment (p50) ---
2025-11-19 16:07:48,485 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:777 - Starting correction experiment from beginning...
2025-11-19 16:07:50,069 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [1/69] 42: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,113 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [2/69] 65: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,212 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [3/69] 67: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,308 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [4/69] 68: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,397 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [5/69] 69: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,492 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [6/69] 75: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,592 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [7/69] 78: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,684 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [8/69] 106: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,788 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [9/69] 131: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:50,868 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [10/69] 146: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,040 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [11/69] 158: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,125 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [12/69] 169: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,205 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [13/69] 178: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,297 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [14/69] 180: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,397 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [15/69] 181: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,492 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [16/69] 196: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,598 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [17/69] 198: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,683 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [18/69] 203: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,765 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [19/69] 233: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:51,857 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [20/69] 245: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,018 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [21/69] 264: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,098 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [22/69] 275: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,184 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [23/69] 295: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,265 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [24/69] 302: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,350 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [25/69] 303: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,443 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [26/69] 314: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,542 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [27/69] 324: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,638 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [28/69] 328: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,743 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [29/69] 338: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:52,830 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [30/69] 340: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,016 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [31/69] 342: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,121 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [32/69] 343: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,202 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [33/69] 350: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,358 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [34/69] 380: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,566 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [35/69] 394: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,655 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [36/69] 403: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,748 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [37/69] 413: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,853 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [38/69] 415: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:53,941 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [39/69] 423: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:54,032 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [40/69] 438: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:54,194 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [41/69] 465: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:54,279 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [42/69] 482: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:54,621 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [43/69] 493: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,099 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [44/69] 535: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,186 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [45/69] 552: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,272 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [46/69] 553: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,359 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [47/69] 572: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,464 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [48/69] 610: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,591 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [49/69] 642: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,705 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [50/69] 691: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:55,707 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:656 -   Checkpoint: 50/69 problems
2025-11-19 16:07:55,909 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [51/69] 694: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,038 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [52/69] 699: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,127 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [53/69] 721: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,232 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [54/69] 747: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,350 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [55/69] 749: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,471 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [56/69] 823: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,560 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [57/69] 825: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,643 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [58/69] 829: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,730 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [59/69] 838: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,817 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [60/69] 845: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:56,989 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [61/69] 846: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,089 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [62/69] 882: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,188 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [63/69] 888: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,325 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [64/69] 906: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,444 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [65/69] 914: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,530 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [66/69] 916: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,629 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [67/69] 917: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,724 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [68/69] 920: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,827 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [69/69] 960: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,829 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:790 - 
✓ Correction complete:
2025-11-19 16:07:57,829 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:791 -   Correction rate: 0.0000 (0/69)
2025-11-19 16:07:57,829 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:793 -   Steering rate: 0.0000
2025-11-19 16:07:57,829 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:796 - 
--- Preservation Experiment (p50) ---
2025-11-19 16:07:57,829 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:806 - Starting preservation experiment from beginning...
2025-11-19 16:07:57,907 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [1/28] 28: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:57,987 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [2/28] 53: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,082 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [3/28] 88: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,186 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [4/28] 116: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,272 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [5/28] 168: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,361 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [6/28] 222: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,446 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [7/28] 281: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,532 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [8/28] 300: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,617 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [9/28] 329: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,702 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [10/28] 334: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,864 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [11/28] 532: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:58,946 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [12/28] 564: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,030 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [13/28] 576: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,115 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [14/28] 628: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,208 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [15/28] 648: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,307 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [16/28] 732: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,394 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [17/28] 764: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,474 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [18/28] 777: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,562 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [19/28] 808: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,647 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [20/28] 818: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,809 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [21/28] 824: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,893 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [22/28] 848: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:07:59,981 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [23/28] 929: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,066 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [24/28] 942: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,153 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [25/28] 947: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,240 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [26/28] 954: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,325 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [27/28] 955: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,406 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [28/28] 961: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:819 - 
✓ Preservation complete:
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:820 -   Preservation rate: 0.0000 (0/28)
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:822 -   Corruption rate: 0.0000 (0/28)
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:824 -   Steering rate: 0.0000
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:838 - 
✓ Percentile 50 complete:
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:839 -   Net benefit = 0.0000 (correction - corruption)
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:840 -   = 0.0000 - 0.0000
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:749 - 
============================================================
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:750 - TESTING PERCENTILE: 75th
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:751 - ============================================================
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:757 - Threshold: 21.0463
2025-11-19 16:08:00,408 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:758 - Expected steering rate: ~25%
2025-11-19 16:08:00,409 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:767 - 
--- Correction Experiment (p75) ---
2025-11-19 16:08:00,409 [INFO] [phase8_2_threshold_optimizer.threshold_optimizer] optimize_threshold:777 - Starting correction experiment from beginning...
2025-11-19 16:08:00,491 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [1/69] 42: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,579 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [2/69] 65: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,664 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [3/69] 67: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,750 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [4/69] 68: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,837 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [5/69] 69: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:00,929 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [6/69] 75: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,028 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [7/69] 78: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,120 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [8/69] 106: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,218 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [9/69] 131: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,300 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [10/69] 146: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,460 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [11/69] 158: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,545 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [12/69] 169: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,625 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [13/69] 178: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,717 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [14/69] 180: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,818 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [15/69] 181: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:01,912 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [16/69] 196: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,015 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [17/69] 198: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,100 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [18/69] 203: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,181 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [19/69] 233: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,274 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [20/69] 245: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,434 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [21/69] 264: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,514 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [22/69] 275: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,600 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [23/69] 295: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,681 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [24/69] 302: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,765 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [25/69] 303: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,858 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [26/69] 314: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:02,959 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [27/69] 324: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:03,053 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [28/69] 328: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:03,157 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [29/69] 338: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:03,244 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [30/69] 340: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:03,414 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [31/69] 342: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:03,518 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [32/69] 343: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:03,599 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [33/69] 350: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
2025-11-19 16:08:03,756 [ERROR] [phase8_2_threshold_optimizer.threshold_optimizer] _run_selective_steering_for_threshold:628 -   [34/69] 380: ERROR - expected mat1 and mat2 to have the same dtype, but got: c10::BFloat16 != float
